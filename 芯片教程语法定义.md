### 1.1 全局声明区 (Static Scope) 在文件顶部进行变量、常量和输入输出的定义。这里的代码决定了芯片的“配置”。  #### 变量声明 (Variable Definition) 使用 \*\*类型注解\*\* 直接指定数据类型和初始值。系统会自动同步到 `chip_variables`。 \*   \*\*格式：\*\* `变量名: 类型 = 初始值` \*   \*\*支持标量：\*\* `Number`, `String`, `Vector`, `Entity` \*   \*\*支持数组：\*\* `ArrayNumber`, `ArrayString`, `ArrayVector`, `ArrayEntity`  \*   \*\*显式常量：\*\* 使用 `Final[Type]` 标记。  \*\*代码示例：\*\*

```
python
hp: Number = 100               # 数字变量
target: Entity = None          # 实体变量，初始为空
names: List[String] = ["A", "B"] # 数组变量
PI: Final[Number] = 3.14       # 显式常量
```

#### 输入输出 (I/O) \*   \*\*INPUT：\*\* `a = INPUT(name="Speed", data_type="Number")` \*   \*\*OUTPUT：\*\* `OUTPUT(INPUT=res, name="Result")` (逻辑区使用)  ---  ### 1.2 逻辑执行区 (Main Block) 所有连线、计算逻辑必须写在 `if __name__ == "__main__":` 内。  #### 变量读写 \*   \*\*读取：\*\* 直接使用变量名。 \*   \*\*写入 (SET)：\*\* `SET(目标变量, 写入值, [触发信号])`     \*   `触发信号` 可选，默认为 1.0 (始终写入)。  \*\*代码示例：\*\*

```
python
if __name__ == "__main__":
    # 读取 hp
    new_hp = SUBTRACT(A=hp, B=10)
    # 写入 hp (仅在按下按钮时)
    SET(hp, new_hp, trigger=is_pressed)
```

---  ## 2. 节点与连接规则  ### 2.1 节点创建 形式：`变量名 = 模块名(输入1=..., 输入2=..., attrs={...}, id="...", label="...")`  ### 2.2 端口引用 1.  \*\*var["端口名"]\*\*：引用特定端口。 2.  \*\*var[n]\*\*：引用第 n 个输出端口（从 0 开始）。 3.  \*\*裸节点变量\*\*：若节点只有一个输出，可直接使用 `var`。  ### 2.3 字面量自动转换 在逻辑区函数调用中直接写数字、字符串或坐标字典，会自动转为 `Constant` 节点。 \*   示例：`MULTIPLY(A=hp, B=2.0)` 这里的 `2.0` 会自动变节点。  ---  ## 3. 数据类型名称 (DataType) 在 `INPUT` 或 `attrs` 中手动指定类型时，\*\*必须统一使用字符串名称\*\*。  \*   \*\*标量类型：\*\* `"Entity"`, `"Number"`, `"String"`, `"Vector"` \*   \*\*数组类型：\*\* `"ArrayNumber"`, `"ArrayString"`, `"ArrayVector"`, `"ArrayEntity"`  \*\*示例写法：\*\*

```
python
# 推荐写法
a = INPUT(name="MySpeed", data_type="Number")
# 兼容旧版数字码 (系统会自动转为 "Entity")
b = INPUT(name="Target", data_type=1)
```

---  ## 4. 核心特性 1.  \*\*自动转化：\*\* 系统自动检测变量副作用。未被 `SET` 过的全局变量在存盘中会自动降级为 \*\*只读常量\*\*。 2.  \*\*前向引用：\*\* 允许在节点定义之前就引用它的输出端口。 3.  \*\*循环连线：\*\* 必须通过 `PrevFrame` (或别名) 模块来打破连线环路

